<div ng-controller="AccountController">
  <h3><b>{{ pageTitle }}</b></h3>
  <ul class="nav nav-tabs" id="accountTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button
        class="nav-link active"
        id="admin-tab"
        data-bs-toggle="tab"
        data-bs-target="#admin"
        type="button"
        role="tab"
        aria-controls="admin"
        aria-selected="true">
        Tài khoản quản trị viên
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="employee-tab"
        data-bs-toggle="tab"
        data-bs-target="#employee"
        type="button"
        role="tab"
        aria-controls="employee"
        aria-selected="false">
        Tài khoản nhân viên
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        class="nav-link"
        id="customer-tab"
        data-bs-toggle="tab"
        data-bs-target="#customer"
        type="button"
        role="tab"
        aria-controls="customer"
        aria-selected="false">
        Tài khoản khách hàng
      </button>
    </li>
  </ul>

  <div class="tab-content mt-3" id="accountTabsContent">
    <!-- Admin Accounts Tab -->
    <div class="tab-pane fade show active" id="admin" role="tabpanel" aria-labelledby="admin-tab">
      <form class="mt-4" name="adminForm" novalidate ng-submit="saveAccount('admin')">
        <div class="row mb-3">
          <label for="matKhauAdmin" class="col-sm-2 col-form-label">Mật Khẩu</label>
          <div class="col-sm-4 position-relative">
            <input
              ng-attr-type="{{ showPasswordAdmin ? 'text' : 'password' }}"
              class="form-control"
              id="matKhauAdmin"
              placeholder="Mật Khẩu"
              ng-model="newAccountAdmin.matKhau"
              required />
            <span
              class="position-absolute top-50 end-0 translate-middle-y pe-3"
              style="cursor: pointer"
              ng-click="showPasswordAdmin = !showPasswordAdmin">
              <i class="fa" ng-class="{'fa-eye': !showPasswordAdmin, 'fa-eye-slash': showPasswordAdmin}"></i>
            </span>
          </div>
          <label for="nhapLaiMatKhauAdmin" class="col-sm-2 col-form-label">Nhập Lại Mật Khẩu</label>
          <div class="col-sm-4 position-relative">
            <input
              ng-attr-type="{{ showRePasswordAdmin ? 'text' : 'password' }}"
              class="form-control"
              id="nhapLaiMatKhauAdmin"
              placeholder="Nhập Lại Mật Khẩu"
              ng-model="newAccountAdmin.nhapLaiMatKhau"
              required />
            <span
              class="position-absolute top-50 end-0 translate-middle-y pe-3"
              style="cursor: pointer"
              ng-click="showRePasswordAdmin = !showRePasswordAdmin">
              <i class="fa" ng-class="{'fa-eye': !showRePasswordAdmin, 'fa-eye-slash': showRePasswordAdmin}"></i>
            </span>
          </div>
        </div>
        <!-- Thông báo ngay khi nhập -->
        <div class="row mb-3" ng-if="newAccountAdmin.matKhau && newAccountAdmin.nhapLaiMatKhau">
          <div class="col-sm-12">
            <span ng-if="newAccountAdmin.matKhau === newAccountAdmin.nhapLaiMatKhau" class="text-success">
              Mật khẩu khớp.
            </span>
            <span ng-if="newAccountAdmin.matKhau !== newAccountAdmin.nhapLaiMatKhau" class="text-danger">
              Mật khẩu và nhập lại mật khẩu không khớp.
            </span>
          </div>
        </div>
        <div class="row mb-3">
          <label for="trangThaiAdmin" class="col-sm-2 col-form-label">Trạng Thái</label>
          <div class="col-sm-4">
            <select class="form-select" id="trangThaiAdmin" ng-model="newAccountAdmin.trangThai" required>
              <option value="true" selected>Hoạt động</option>
              <option value="false">Không hoạt động</option>
            </select>
          </div>
        </div>
        <div>
          <!-- Nút submit bị vô hiệu nếu mật khẩu không trùng -->
          <button
            type="submit"
            class="btn btn-primary me-2"
            ng-disabled="newAccountAdmin.matKhau !== newAccountAdmin.nhapLaiMatKhau">
            {{ isEditModeAdmin ? "Cập Nhật Tài Khoản" : "Thêm Tài Khoản" }}
          </button>
          <button type="button" class="btn btn-secondary" ng-click="resetAdminForm()">Reset</button>
        </div>
      </form>
      <!-- Danh sách tài khoản quản trị viên -->
      <div class="mt-5">
        <h3><b>Danh sách tài khoản quản trị viên</b></h3>
        <table class="table table-bordered mt-3">
          <thead>
            <tr>
              <th scope="col">STT</th>
              <th scope="col">ID Tài Khoản</th>
              <th scope="col">Mật Khẩu</th>
              <th scope="col">Vai Trò</th>
              <th scope="col">Trạng Thái</th>
              <th scope="col">Chức Năng</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="account in accountsAdmin track by $index">
              <th scope="row">{{ $index + 1 }}</th>
              <td>{{ account.idTaiKhoan }}</td>
              <td>{{ account.matKhau }}</td>
              <td>{{ account.vaiTro }}</td>
              <td>{{ account.trangThai ? 'Hoạt động' : 'Không hoạt động' }}</td>
              <td>
                <button class="btn btn-warning btn-sm" ng-click="selectAccount(account, 'admin')">Sửa</button>
                <button class="btn btn-danger btn-sm" ng-click="deleteAccount(account.idTaiKhoan, 'admin')">Xóa</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Tương tự, cập nhật form cho Employee và Customer theo cấu trúc trên -->
    <!-- Employee Accounts Tab -->
    <div class="tab-pane fade" id="employee" role="tabpanel" aria-labelledby="employee-tab">
      <form class="mt-4" name="employeeForm" novalidate ng-submit="saveAccount('employee')">
        <div class="row mb-3">
          <label for="matKhauNhanVien" class="col-sm-2 col-form-label">Mật Khẩu</label>
          <div class="col-sm-4 position-relative">
            <input
              ng-attr-type="{{ showPasswordEmployee ? 'text' : 'password' }}"
              class="form-control"
              id="matKhauNhanVien"
              placeholder="Mật Khẩu"
              ng-model="newAccountEmployee.matKhau"
              required />
            <span
              class="position-absolute top-50 end-0 translate-middle-y pe-3"
              style="cursor: pointer"
              ng-click="showPasswordEmployee = !showPasswordEmployee">
              <i class="fa" ng-class="{'fa-eye': !showPasswordEmployee, 'fa-eye-slash': showPasswordEmployee}"></i>
            </span>
          </div>
          <label for="nhapLaiMatKhauNhanVien" class="col-sm-2 col-form-label">Nhập Lại Mật Khẩu</label>
          <div class="col-sm-4 position-relative">
            <input
              ng-attr-type="{{ showRePasswordEmployee ? 'text' : 'password' }}"
              class="form-control"
              id="nhapLaiMatKhauNhanVien"
              placeholder="Nhập Lại Mật Khẩu"
              ng-model="newAccountEmployee.nhapLaiMatKhau"
              required />
            <span
              class="position-absolute top-50 end-0 translate-middle-y pe-3"
              style="cursor: pointer"
              ng-click="showRePasswordEmployee = !showRePasswordEmployee">
              <i class="fa" ng-class="{'fa-eye': !showRePasswordEmployee, 'fa-eye-slash': showRePasswordEmployee}"></i>
            </span>
          </div>
        </div>
        <div class="row mb-3" ng-if="newAccountEmployee.matKhau && newAccountEmployee.nhapLaiMatKhau">
          <div class="col-sm-12">
            <span ng-if="newAccountEmployee.matKhau === newAccountEmployee.nhapLaiMatKhau" class="text-success">
              Mật khẩu khớp.
            </span>
            <span ng-if="newAccountEmployee.matKhau !== newAccountEmployee.nhapLaiMatKhau" class="text-danger">
              Mật khẩu và nhập lại mật khẩu không khớp.
            </span>
          </div>
        </div>
        <div class="row mb-3">
          <label for="trangThaiNhanVien" class="col-sm-2 col-form-label">Trạng Thái</label>
          <div class="col-sm-4">
            <select class="form-select" id="trangThaiNhanVien" ng-model="newAccountEmployee.trangThai" required>
              <option value="true" selected>Hoạt động</option>
              <option value="false">Không hoạt động</option>
            </select>
          </div>
        </div>
        <div>
          <button
            type="submit"
            class="btn btn-primary me-2"
            ng-disabled="newAccountEmployee.matKhau !== newAccountEmployee.nhapLaiMatKhau">
            {{ isEditModeEmployee ? "Cập Nhật Tài Khoản" : "Thêm Tài Khoản" }}
          </button>
          <button type="button" class="btn btn-secondary" ng-click="resetEmployeeForm()">Reset</button>
        </div>
      </form>
      <div class="mt-5">
        <h3><b>Danh sách tài khoản nhân viên</b></h3>
        <table class="table table-bordered mt-3">
          <thead>
            <tr>
              <th scope="col">STT</th>
              <th scope="col">ID Tài Khoản</th>
              <th scope="col">Mật Khẩu</th>
              <th scope="col">Vai Trò</th>
              <th scope="col">Trạng Thái</th>
              <th scope="col">Chức Năng</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="account in accountsEmployee track by $index">
              <th scope="row">{{ $index + 1 }}</th>
              <td>{{ account.idTaiKhoan }}</td>
              <td>{{ account.matKhau }}</td>
              <td>{{ account.vaiTro }}</td>
              <td>{{ account.trangThai ? 'Hoạt động' : 'Không hoạt động' }}</td>
              <td>
                <button class="btn btn-warning btn-sm" ng-click="selectAccount(account, 'employee')">Sửa</button>
                <button class="btn btn-danger btn-sm" ng-click="deleteAccount(account.idTaiKhoan, 'employee')">
                  Xóa
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Customer Accounts Tab -->
    <div class="tab-pane fade" id="customer" role="tabpanel" aria-labelledby="customer-tab">
      <form class="mt-4" name="customerForm" novalidate ng-submit="saveAccount('customer')">
        <div class="row mb-3">
          <label for="matKhauKhachHang" class="col-sm-2 col-form-label">Mật Khẩu</label>
          <div class="col-sm-4 position-relative">
            <input
              ng-attr-type="{{ showPasswordCustomer ? 'text' : 'password' }}"
              class="form-control"
              id="matKhauKhachHang"
              placeholder="Mật Khẩu"
              ng-model="newAccountCustomer.matKhau"
              required />
            <span
              class="position-absolute top-50 end-0 translate-middle-y pe-3"
              style="cursor: pointer"
              ng-click="showPasswordCustomer = !showPasswordCustomer">
              <i class="fa" ng-class="{'fa-eye': !showPasswordCustomer, 'fa-eye-slash': showPasswordCustomer}"></i>
            </span>
          </div>
          <label for="nhapLaiMatKhauKhachHang" class="col-sm-2 col-form-label">Nhập Lại Mật Khẩu</label>
          <div class="col-sm-4 position-relative">
            <input
              ng-attr-type="{{ showRePasswordCustomer ? 'text' : 'password' }}"
              class="form-control"
              id="nhapLaiMatKhauKhachHang"
              placeholder="Nhập Lại Mật Khẩu"
              ng-model="newAccountCustomer.nhapLaiMatKhau"
              required />
            <span
              class="position-absolute top-50 end-0 translate-middle-y pe-3"
              style="cursor: pointer"
              ng-click="showRePasswordCustomer = !showRePasswordCustomer">
              <i class="fa" ng-class="{'fa-eye': !showRePasswordCustomer, 'fa-eye-slash': showRePasswordCustomer}"></i>
            </span>
          </div>
        </div>
        <div class="row mb-3" ng-if="newAccountCustomer.matKhau && newAccountCustomer.nhapLaiMatKhau">
          <div class="col-sm-12">
            <span ng-if="newAccountCustomer.matKhau === newAccountCustomer.nhapLaiMatKhau" class="text-success">
              Mật khẩu khớp.
            </span>
            <span ng-if="newAccountCustomer.matKhau !== newAccountCustomer.nhapLaiMatKhau" class="text-danger">
              Mật khẩu và nhập lại mật khẩu không khớp.
            </span>
          </div>
        </div>
        <div class="row mb-3">
          <label for="trangThaiKhachHang" class="col-sm-2 col-form-label">Trạng Thái</label>
          <div class="col-sm-4">
            <select class="form-select" id="trangThaiKhachHang" ng-model="newAccountCustomer.trangThai" required>
              <option value="true" selected>Hoạt động</option>
              <option value="false">Không hoạt động</option>
            </select>
          </div>
        </div>
        <div>
          <button
            type="submit"
            class="btn btn-primary me-2"
            ng-disabled="newAccountCustomer.matKhau !== newAccountCustomer.nhapLaiMatKhau">
            {{ isEditModeCustomer ? "Cập Nhật Tài Khoản" : "Thêm Tài Khoản" }}
          </button>
          <button type="button" class="btn btn-secondary" ng-click="resetCustomerForm()">Reset</button>
        </div>
      </form>
      <div class="mt-5">
        <h3><b>Danh sách tài khoản khách hàng</b></h3>
        <table class="table table-bordered mt-3">
          <thead>
            <tr>
              <th scope="col">STT</th>
              <th scope="col">ID Tài Khoản</th>
              <th scope="col">Mật Khẩu</th>
              <th scope="col">Vai Trò</th>
              <th scope="col">Trạng Thái</th>
              <th scope="col">Chức Năng</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="account in accountsCustomer track by $index">
              <th scope="row">{{ $index + 1 }}</th>
              <td>{{ account.idTaiKhoan }}</td>
              <td>{{ account.matKhau }}</td>
              <td>{{ account.vaiTro }}</td>
              <td>{{ account.trangThai ? 'Hoạt động' : 'Không hoạt động' }}</td>
              <td>
                <button class="btn btn-warning btn-sm" ng-click="selectAccount(account, 'customer')">Sửa</button>
                <button class="btn btn-danger btn-sm" ng-click="deleteAccount(account.idTaiKhoan, 'customer')">
                  Xóa
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
